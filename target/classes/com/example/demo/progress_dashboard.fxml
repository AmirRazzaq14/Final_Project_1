<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.chart.*?>
<?import javafx.geometry.*?>

<AnchorPane fx:controller="com.example.demo.ProgressDashboardController"
            xmlns:fx="http://javafx.com/fxml" prefWidth="1200" prefHeight="800"
            stylesheets="@chart-styles.css"
            style="-fx-background-color: linear-gradient(to bottom right, #667eea 0%, #764ba2 100%);">

    <ScrollPane fitToWidth="true" fitToHeight="true" AnchorPane.topAnchor="0" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" style="-fx-background: transparent; -fx-background-color: transparent; -fx-control-inner-background: transparent;">
        <VBox spacing="25" style="-fx-padding: 30; -fx-background-color: transparent;">
            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-padding: 20;">
                <Label text="Progress Dashboard" style="-fx-text-fill: white; -fx-font-size: 42px; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 10, 0.5, 0, 0);" />
                <Region HBox.hgrow="ALWAYS" />
                <Button text="Add Progress Entry" onAction="#handleAddProgress" 
                        style="-fx-background-color: white; -fx-background-radius: 25; -fx-text-fill: #667eea; -fx-font-size: 16px; -fx-font-weight: bold; -fx-pref-width: 200; -fx-pref-height: 45; -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0.5, 0, 2);" />
                <Button text="Return to Home" onAction="#handleBack" 
                        style="-fx-background-color: white; -fx-background-radius: 25; -fx-text-fill: #667eea; -fx-font-size: 16px; -fx-font-weight: bold; -fx-pref-width: 180; -fx-pref-height: 45; -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0.5, 0, 2);" />
            </HBox>

            <!-- Connection Warning -->
            <HBox fx:id="connectionWarningBox" alignment="CENTER" spacing="10" style="-fx-background-color: rgba(243,156,18,0.2); -fx-background-radius: 10; -fx-padding: 15; -fx-border-color: #f39c12; -fx-border-width: 2; -fx-border-radius: 10;" visible="false">
                <Label text="âš " style="-fx-text-fill: #f39c12; -fx-font-size: 24px;" />
                <Label fx:id="connectionWarningLabel" text="Firebase connection not available. Using local data storage." 
                       style="-fx-text-fill: #f39c12; -fx-font-size: 14px; -fx-font-weight: bold;" />
            </HBox>

            <!-- Charts Grid -->
            <GridPane hgap="20" vgap="20" style="-fx-padding: 20;">
                <!-- Weight Chart -->
                <VBox style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 15; -fx-padding: 20; -fx-pref-width: 580;" GridPane.columnIndex="0" GridPane.rowIndex="0">
                    <Label text="Weight Progress" style="-fx-text-fill: #2c3e50; -fx-font-size: 20px; -fx-font-weight: bold;" />
                    <LineChart fx:id="weightChart" createSymbols="true" style="-fx-pref-height: 300; -fx-text-fill: #2c3e50; -fx-legend-visible: true;">
                        <xAxis><CategoryAxis label="Date" style="-fx-tick-label-fill: #2c3e50;" /></xAxis>
                        <yAxis><NumberAxis label="Weight (lbs)" style="-fx-tick-label-fill: #2c3e50;" /></yAxis>
                    </LineChart>
                </VBox>

                <!-- Body Fat Chart -->
                <VBox style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 15; -fx-padding: 20; -fx-pref-width: 580;" GridPane.columnIndex="1" GridPane.rowIndex="0">
                    <Label text="Body Fat Percentage" style="-fx-text-fill: #2c3e50; -fx-font-size: 20px; -fx-font-weight: bold;" />
                    <LineChart fx:id="bodyFatChart" createSymbols="true" style="-fx-pref-height: 300; -fx-text-fill: #2c3e50; -fx-legend-visible: true;">
                        <xAxis><CategoryAxis label="Date" style="-fx-tick-label-fill: #2c3e50;" /></xAxis>
                        <yAxis><NumberAxis label="Body Fat %" style="-fx-tick-label-fill: #2c3e50;" /></yAxis>
                    </LineChart>
                </VBox>

                <!-- PRs Chart -->
                <VBox style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 15; -fx-padding: 20; -fx-pref-width: 580;" GridPane.columnIndex="0" GridPane.rowIndex="1">
                    <Label text="Personal Records (PRs)" style="-fx-text-fill: #2c3e50; -fx-font-size: 20px; -fx-font-weight: bold;" />
                    <BarChart fx:id="prChart" style="-fx-pref-height: 300; -fx-text-fill: #2c3e50; -fx-legend-visible: true;">
                        <xAxis><CategoryAxis label="Exercise" style="-fx-tick-label-fill: #2c3e50;" /></xAxis>
                        <yAxis><NumberAxis label="Weight (lbs)" style="-fx-tick-label-fill: #2c3e50;" /></yAxis>
                    </BarChart>
                </VBox>

                <!-- Calorie Adherence Chart -->
                <VBox style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 15; -fx-padding: 20; -fx-pref-width: 580;" GridPane.columnIndex="1" GridPane.rowIndex="1">
                    <Label text="Daily Calorie Adherence (%)" style="-fx-text-fill: #2c3e50; -fx-font-size: 20px; -fx-font-weight: bold;" />
                    <LineChart fx:id="calorieChart" createSymbols="true" style="-fx-pref-height: 300; -fx-text-fill: #2c3e50; -fx-legend-visible: true;">
                        <xAxis><CategoryAxis label="Date" style="-fx-tick-label-fill: #2c3e50;" /></xAxis>
                        <yAxis><NumberAxis label="Adherence %" upperBound="100" style="-fx-tick-label-fill: #2c3e50;" /></yAxis>
                    </LineChart>
                </VBox>

                <!-- Steps Chart -->
                <VBox style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 15; -fx-padding: 20; -fx-pref-width: 1180;" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="2">
                    <Label text="Daily Steps" style="-fx-text-fill: #2c3e50; -fx-font-size: 20px; -fx-font-weight: bold;" />
                    <BarChart fx:id="stepsChart" style="-fx-pref-height: 300; -fx-text-fill: #2c3e50; -fx-legend-visible: true;">
                        <xAxis><CategoryAxis label="Date" style="-fx-tick-label-fill: #2c3e50;" /></xAxis>
                        <yAxis><NumberAxis label="Steps" style="-fx-tick-label-fill: #2c3e50;" /></yAxis>
                    </BarChart>
                </VBox>
            </GridPane>
        </VBox>
    </ScrollPane>
</AnchorPane>

